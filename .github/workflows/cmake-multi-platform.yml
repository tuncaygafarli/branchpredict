name: Fast CMake Build

on:
  push:
    branches: [ "gui" ]
  pull_request:
    branches: [ "gui" ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        submodules: recursive
    
    - name: Cache SFML
      uses: actions/cache@v3
      id: cache-sfml
      with:
        path: |
          ~/.cache/sfml
          build/_deps
        key: ${{ runner.os }}-sfml-2.6.1-${{ hashFiles('CMakeLists.txt') }}
    
    - name: Install system SFML (FASTEST)
      run: |
        sudo apt-get update
        sudo apt-get install -y libsfml-dev  # Use pre-built system package
    
    - name: Configure CMake
      run: |
        cmake -B build \
          -DCMAKE_BUILD_TYPE=Release \
          -DBUILD_TESTS=OFF \
          # Try to use system SFML first
          -DSFML_DIR=/usr/lib/cmake/SFML \
          -S .
    
    - name: Build
      run: cmake --build build --parallel 4  # Use parallel builds!
